<!DOCTYPE html>
<html>
<head>
<title>Dodaj waga</title>
<script src="{{url_for('static', filename='d3.js')}}"></script>

<style>

input[type="text"]
{ padding: 20px 10px; line-height: 10px;
font-size: 26px;
margin-top: 30px;

}

button {

  font-size: 40px;

  margin: 20px;
}
</style>
</head>
<body>

  <div class="container">
    <div class="row">
      <div class="col">
        <h1>Raty równe kredytu hipotecznego</h1>
        <hr>
      </div>
    </div>
  </div>

  {% if feedback %}
<p class="text-danger float-right">{{ feedback }}</p>
{% endif %}

{% if dane %}
<div id="chart">



</div>
<script type="text/javascript">
  dane = {{dane|tojson}};

  console.log(dane)


  var margin = {top: 30, right: 30, bottom: 70, left: 30},
      width_chart = 500,
      width = width_chart - margin.left - margin.right,
      height = 120- margin.top - margin.bottom;


      // append the svg object to the body of the page
      var svg = d3.select("#chart")
        .append("svg")
          .attr("class", "svg-holder")
          .attr("width", width + margin.left + margin.right)
          .attr("height", height + margin.top + margin.bottom)
          .attr("style", "border:1px solid black;")
          .style('background', "white")
          .append("g")
            .attr("transform",
                  "translate(" + margin.left + "," + margin.top + ")");



        const xscale = d3.scaleTime()
            .domain([0, d3.max([dane.kapital, dane.zwrot]) ])
            .range([0, width]);

        svg.append("rect")
            .attr("x", 0)
            .attr("y", 0)
            .attr("width", xscale(dane.kapital))
            .attr("height", 20)
            .attr("fill", 'red');

            svg.append("rect")
                .attr("x", 0)
                .attr("y", 40)
                .attr("width", xscale(dane.zwrot))
                .attr("height", 20)
                .attr("fill", 'blue');


            d3.select("#chart")
                      .append("p")
                      .text("Pożyczyłeś " + dane.kapital)


            d3.select("#chart")
                      .append("p")
                      .text("Rata równa " + dane.rata)


            d3.select("#chart")
                      .append("p")
                      .text("Oddasz " + dane.zwrot)


            d3.select("#chart")
                .append("p")
                .text("Proporcja " + ((dane.zwrot/dane.kapital)*100).toFixed(2) + "%")




      // (dane.zwrot/dane.kapital)*100) )

</script>


{% endif %}

<form action="/" method="POST">

    <div class="form-group">
      <input type="text" class="form-control" id="kapital" name="kapital" placeholder="Kapitał">
    </div>

    <div class="form-group">
      <input type="text" class="form-control" id="procent" name="procent" placeholder="Oprocentowanie roczne">
    </div>

    <div class="form-group">
      <input type="text" class="form-control" id="liczba_rat" name="liczba_rat" placeholder="Liczba rat" value="360">
    </div>

<div>
  <button type="submit" class="btn btn-primary">Dodaj</button>
</div>


</form>


</body>
</html>
