<!DOCTYPE html>
<html>
  <head>
    <title>Procenty - kredyty hipoteczne</title>
    <script src="{{url_for('static', filename='d3.js')}}"></script>
    <style type="text/css">
      .container {
        padding-top: 12px;
      }

      img {

        border-style: dotted;
      }

      h2 {color: black;}

      input[type="text"]
      { padding: 20px 10px; line-height: 10px;
      font-size: 26px;
      margin-top: 30px;

      }

      button {

        font-size: 40px;

        margin: 20px;
      }

      path {
        fill: none;
        stroke-width: 2px;
        stroke: black;
      }

      path.kret {
        fill: none;
        stroke-width: 4px;
        stroke: rgb(181, 32, 32);
      }

      body {
         background-color: lightblue;
      }          


      table, th, td {
        border: 1px solid;
        padding: 5px;
      }

      td {
        text-align: right;
        width: 100px;
      }

    </style>
  </head>
  <body>


        <div id="chart" class="divelement">
        </div>


        
        <div id="chart2" class="divelement">
        </div>

      
      <script type="text/javascript">

       

        var kredyt_dane = JSON.parse('{{dane | tojson|safe}}');

        

        var parseDate = d3.timeParse("%Y-%m-%d");
        var parseDateInfl = d3.timeParse("%m/%Y");

        kredyt_dane['raty'].forEach(function (d) {
            d.dzien = parseDate(d.dzien)
            d.K = parseFloat(d.K)
            d.rata = parseFloat(d.rata)

        });

        var margin = { top: 60, right: 50, bottom: 70, left: 100 },
    width = 1300 - margin.left - margin.right,
    height = 450 - margin.top - margin.bottom;


  // append the svg object to the body of the page
  var svg = d3.select("#chart")
    .append("svg")
    .attr("class", "svg-holder")
    .attr("width", width + margin.left + margin.right)
    .attr("height", height + margin.top + margin.bottom)
    .attr("style", "border:1px solid black;")
    .style('background', "white")
    .append("g")
    .attr("transform",
      "translate(" + margin.left + "," + margin.top + ")");

  var xscale = d3.scaleTime()
    .domain(d3.extent(kredyt_dane['raty'], d => d.dzien))
    .range([0, width]);




  svg.append("g")
    .attr("class", "xAxis")
    .attr("transform", "translate(0," + height + ")")
    .call(d3.axisBottom(xscale).tickFormat(d3.timeFormat('%Y-%m-%d')))
    .selectAll("text")
    .attr("transform", "translate(-10,0)rotate(-45)")
    .style("text-anchor", "end")
    .style("font-size", "13px");


  d3.selectAll("g.xAxis g.tick")
    .append("line")
    .attr("class", "gridline")
    .attr("x1", 0)
    .attr("y1", -height)
    .attr("x2", 0)
    .attr("y2", 0);



  var maxYvalue = d3.max(kredyt_dane['raty'], function (d) { return d.K });
  var minYvalue = d3.min(kredyt_dane['raty'], function (d) { return d.K });
  // Add Y axis

  var yscale = d3.scaleLinear()
    .domain([0, maxYvalue])
    .range([height, 0]);

  formatPerc = function (d) { return d3.format(".2f")(d) + " zł"; }

  svg.append("g")
    .attr("class", "yAxis")
    .call(d3.axisLeft(yscale).tickFormat(formatPerc))
    .style("font-size", "13px");

  d3.selectAll("g.yAxis g.tick")
    .append("line")
    .attr("class", "gridline")
    .attr("x1", 0)
    .attr("y1", 0)
    .attr("x2", width)
    .attr("y2", 0);






// Add the line
svg.append("path")
      .datum(kredyt_dane['raty'])
      .attr("fill", "none")
      .attr("class", "kret")
      .attr("stroke-width", 1.5)
      .attr("d", d3.line()
        .x(function(d) { return xscale(d.dzien) })
        .y(function(d) { return yscale(d.K) })
        )

  svg.append("text")
    .attr("class", "text-tytul")
    .attr("x", -50)
    .attr("y", -20)
    .text("kapitał do spłaty")


      </script>

    <script type="text/javascript">



        var svg = d3.select("#chart2")
        .append("svg")
        .attr("class", "svg-holder")
        .attr("width", width + margin.left + margin.right)
        .attr("height", height + margin.top + margin.bottom)
        .attr("style", "border:1px solid black;")
        .style('background', "white")
        .append("g")
        .attr("transform",
        "translate(" + margin.left + "," + margin.top + ")");

        svg.append("g")
    .attr("class", "xAxis")
    .attr("transform", "translate(0," + height + ")")
    .call(d3.axisBottom(xscale).tickFormat(d3.timeFormat('%Y-%m-%d')))
    .selectAll("text")
    .attr("transform", "translate(-10,0)rotate(-45)")
    .style("text-anchor", "end")
    .style("font-size", "13px");


  d3.selectAll("g.xAxis g.tick")
    .append("line")
    .attr("class", "gridline")
    .attr("x1", 0)
    .attr("y1", -height)
    .attr("x2", 0)
    .attr("y2", 0);



    var maxYvalue = d3.max(kredyt_dane['raty'], function (d) { return d.rata });
  var minYvalue = d3.min(kredyt_dane['raty'], function (d) { return d.rata });
  // Add Y axis

  var yscale = d3.scaleLinear()
    .domain([0, maxYvalue])
    .range([height, 0]);

  formatPerc = function (d) { return d3.format(".2f")(d) + " zł"; }

  svg.append("g")
    .attr("class", "yAxis")
    .call(d3.axisLeft(yscale).tickFormat(formatPerc))
    .style("font-size", "13px");

  d3.selectAll("g.yAxis g.tick")
    .append("line")
    .attr("class", "gridline")
    .attr("x1", 0)
    .attr("y1", 0)
    .attr("x2", width)
    .attr("y2", 0);



    var mybars = svg.selectAll(".mybar").data(kredyt_dane['raty'])

mybars
  .enter()
  .append("circle")
  .attr("cx", function (d) { return xscale(d.dzien); })
  .attr("cy", function (d) { return yscale(d.rata); })
  .attr("r", 3)
  .attr("class", "mycircle");


  mybars.enter().append("line").attr()


svg.append("text")
  .attr("class", "text-tytul")
  .attr("x", -50)
  .attr("y", -20)
  .text("raty")

        
    </script>

      
    

  </body>
</html>
